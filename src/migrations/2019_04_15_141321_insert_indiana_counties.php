<?php

use Appleton\Taxes\Countries\US\Indiana\AdamsIncome\AdamsIncome;
use Appleton\Taxes\Countries\US\Indiana\AllenIncome\AllenIncome;
use Appleton\Taxes\Countries\US\Indiana\BartholomewIncome\BartholomewIncome;
use Appleton\Taxes\Countries\US\Indiana\BentonIncome\BentonIncome;
use Appleton\Taxes\Countries\US\Indiana\BlackfordIncome\BlackfordIncome;
use Appleton\Taxes\Countries\US\Indiana\BooneIncome\BooneIncome;
use Appleton\Taxes\Countries\US\Indiana\BrownIncome\BrownIncome;
use Appleton\Taxes\Countries\US\Indiana\CarrollIncome\CarrollIncome;
use Appleton\Taxes\Countries\US\Indiana\CassIncome\CassIncome;
use Appleton\Taxes\Countries\US\Indiana\ClarkIncome\ClarkIncome;
use Appleton\Taxes\Countries\US\Indiana\ClayIncome\ClayIncome;
use Appleton\Taxes\Countries\US\Indiana\ClintonIncome\ClintonIncome;
use Appleton\Taxes\Countries\US\Indiana\CrawfordIncome\CrawfordIncome;
use Appleton\Taxes\Countries\US\Indiana\DaviessIncome\DaviessIncome;
use Appleton\Taxes\Countries\US\Indiana\DearbornIncome\DearbornIncome;
use Appleton\Taxes\Countries\US\Indiana\DecaturIncome\DecaturIncome;
use Appleton\Taxes\Countries\US\Indiana\DeKalbIncome\DeKalbIncome;
use Appleton\Taxes\Countries\US\Indiana\DelawareIncome\DelawareIncome;
use Appleton\Taxes\Countries\US\Indiana\DuboisIncome\DuboisIncome;
use Appleton\Taxes\Countries\US\Indiana\ElkhartIncome\ElkhartIncome;
use Appleton\Taxes\Countries\US\Indiana\FayetteIncome\FayetteIncome;
use Appleton\Taxes\Countries\US\Indiana\FloydIncome\FloydIncome;
use Appleton\Taxes\Countries\US\Indiana\FountainIncome\FountainIncome;
use Appleton\Taxes\Countries\US\Indiana\FranklinIncome\FranklinIncome;
use Appleton\Taxes\Countries\US\Indiana\FultonIncome\FultonIncome;
use Appleton\Taxes\Countries\US\Indiana\GibsonIncome\GibsonIncome;
use Appleton\Taxes\Countries\US\Indiana\GrantIncome\GrantIncome;
use Appleton\Taxes\Countries\US\Indiana\GreeneIncome\GreeneIncome;
use Appleton\Taxes\Countries\US\Indiana\HamiltonIncome\HamiltonIncome;
use Appleton\Taxes\Countries\US\Indiana\HancockIncome\HancockIncome;
use Appleton\Taxes\Countries\US\Indiana\HarrisonIncome\HarrisonIncome;
use Appleton\Taxes\Countries\US\Indiana\HendricksIncome\HendricksIncome;
use Appleton\Taxes\Countries\US\Indiana\HenryIncome\HenryIncome;
use Appleton\Taxes\Countries\US\Indiana\HowardIncome\HowardIncome;
use Appleton\Taxes\Countries\US\Indiana\HuntingtonIncome\HuntingtonIncome;
use Appleton\Taxes\Countries\US\Indiana\JacksonIncome\JacksonIncome;
use Appleton\Taxes\Countries\US\Indiana\JasperIncome\JasperIncome;
use Appleton\Taxes\Countries\US\Indiana\JayIncome\JayIncome;
use Appleton\Taxes\Countries\US\Indiana\JeffersonIncome\JeffersonIncome;
use Appleton\Taxes\Countries\US\Indiana\JenningsIncome\JenningsIncome;
use Appleton\Taxes\Countries\US\Indiana\JohnsonIncome\JohnsonIncome;
use Appleton\Taxes\Countries\US\Indiana\KnoxIncome\KnoxIncome;
use Appleton\Taxes\Countries\US\Indiana\KosciuskoIncome\KosciuskoIncome;
use Appleton\Taxes\Countries\US\Indiana\LaGrangeIncome\LaGrangeIncome;
use Appleton\Taxes\Countries\US\Indiana\LakeIncome\LakeIncome;
use Appleton\Taxes\Countries\US\Indiana\LaPorteIncome\LaPorteIncome;
use Appleton\Taxes\Countries\US\Indiana\LawrenceIncome\LawrenceIncome;
use Appleton\Taxes\Countries\US\Indiana\MadisonIncome\MadisonIncome;
use Appleton\Taxes\Countries\US\Indiana\MarionIncome\MarionIncome;
use Appleton\Taxes\Countries\US\Indiana\MarshallIncome\MarshallIncome;
use Appleton\Taxes\Countries\US\Indiana\MartinIncome\MartinIncome;
use Appleton\Taxes\Countries\US\Indiana\MiamiIncome\MiamiIncome;
use Appleton\Taxes\Countries\US\Indiana\MonroeIncome\MonroeIncome;
use Appleton\Taxes\Countries\US\Indiana\MontgomeryIncome\MontgomeryIncome;
use Appleton\Taxes\Countries\US\Indiana\MorganIncome\MorganIncome;
use Appleton\Taxes\Countries\US\Indiana\NewtonIncome\NewtonIncome;
use Appleton\Taxes\Countries\US\Indiana\NobleIncome\NobleIncome;
use Appleton\Taxes\Countries\US\Indiana\OhioIncome\OhioIncome;
use Appleton\Taxes\Countries\US\Indiana\OrangeIncome\OrangeIncome;
use Appleton\Taxes\Countries\US\Indiana\OwenIncome\OwenIncome;
use Appleton\Taxes\Countries\US\Indiana\ParkeIncome\ParkeIncome;
use Appleton\Taxes\Countries\US\Indiana\PerryIncome\PerryIncome;
use Appleton\Taxes\Countries\US\Indiana\PikeIncome\PikeIncome;
use Appleton\Taxes\Countries\US\Indiana\PorterIncome\PorterIncome;
use Appleton\Taxes\Countries\US\Indiana\PoseyIncome\PoseyIncome;
use Appleton\Taxes\Countries\US\Indiana\PulaskiIncome\PulaskiIncome;
use Appleton\Taxes\Countries\US\Indiana\PutnamIncome\PutnamIncome;
use Appleton\Taxes\Countries\US\Indiana\RandolphIncome\RandolphIncome;
use Appleton\Taxes\Countries\US\Indiana\RipleyIncome\RipleyIncome;
use Appleton\Taxes\Countries\US\Indiana\RushIncome\RushIncome;
use Appleton\Taxes\Countries\US\Indiana\ScottIncome\ScottIncome;
use Appleton\Taxes\Countries\US\Indiana\ShelbyIncome\ShelbyIncome;
use Appleton\Taxes\Countries\US\Indiana\SpencerIncome\SpencerIncome;
use Appleton\Taxes\Countries\US\Indiana\StarkeIncome\StarkeIncome;
use Appleton\Taxes\Countries\US\Indiana\SteubenIncome\SteubenIncome;
use Appleton\Taxes\Countries\US\Indiana\StJosephIncome\StJosephIncome;
use Appleton\Taxes\Countries\US\Indiana\SullivanIncome\SullivanIncome;
use Appleton\Taxes\Countries\US\Indiana\SwitzerlandIncome\SwitzerlandIncome;
use Appleton\Taxes\Countries\US\Indiana\TippecanoeIncome\TippecanoeIncome;
use Appleton\Taxes\Countries\US\Indiana\TiptonIncome\TiptonIncome;
use Appleton\Taxes\Countries\US\Indiana\UnionIncome\UnionIncome;
use Appleton\Taxes\Countries\US\Indiana\VanderburghIncome\VanderburghIncome;
use Appleton\Taxes\Countries\US\Indiana\VermillionIncome\VermillionIncome;
use Appleton\Taxes\Countries\US\Indiana\VigoIncome\VigoIncome;
use Appleton\Taxes\Countries\US\Indiana\WabashIncome\WabashIncome;
use Appleton\Taxes\Countries\US\Indiana\WarrenIncome\WarrenIncome;
use Appleton\Taxes\Countries\US\Indiana\WarrickIncome\WarrickIncome;
use Appleton\Taxes\Countries\US\Indiana\WashingtonIncome\WashingtonIncome;
use Appleton\Taxes\Countries\US\Indiana\WayneIncome\WayneIncome;
use Appleton\Taxes\Countries\US\Indiana\WellsIncome\WellsIncome;
use Appleton\Taxes\Countries\US\Indiana\WhiteIncome\WhiteIncome;
use Appleton\Taxes\Countries\US\Indiana\WhitleyIncome\WhitleyIncome;
use Appleton\Taxes\Models\TaxArea;
use Illuminate\Database\Migrations\Migration;
use Illuminate\Support\Facades\DB;

class InsertIndianaCounties extends Migration
{
    private const STATE_FILE = '2019_04_15_141321_indiana_counties.ini';

    private const CLASSES = [
        'Adams' => AdamsIncome::class,
        'Allen' => AllenIncome::class,
        'Bartholomew' => BartholomewIncome::class,
        'Benton' => BentonIncome::class,
        'Blackford' => BlackfordIncome::class,
        'Boone' => BooneIncome::class,
        'Brown' => BrownIncome::class,
        'Carroll' => CarrollIncome::class,
        'Cass' => CassIncome::class,
        'Clark' => ClarkIncome::class,
        'Clay' => ClayIncome::class,
        'Clinton' => ClintonIncome::class,
        'Crawford' => CrawfordIncome::class,
        'Daviess' => DaviessIncome::class,
        'Dearborn' => DearbornIncome::class,
        'Decatur' => DecaturIncome::class,
        'DeKalb' => DeKalbIncome::class,
        'Delaware' => DelawareIncome::class,
        'Dubois' => DuboisIncome::class,
        'Elkhart' => ElkhartIncome::class,
        'Fayette' => FayetteIncome::class,
        'Floyd' => FloydIncome::class,
        'Fountain' => FountainIncome::class,
        'Franklin' => FranklinIncome::class,
        'Fulton' => FultonIncome::class,
        'Gibson' => GibsonIncome::class,
        'Grant' => GrantIncome::class,
        'Greene' => GreeneIncome::class,
        'Hamilton' => HamiltonIncome::class,
        'Hancock' => HancockIncome::class,
        'Harrison' => HarrisonIncome::class,
        'Hendricks' => HendricksIncome::class,
        'Henry' => HenryIncome::class,
        'Howard' => HowardIncome::class,
        'Huntington' => HuntingtonIncome::class,
        'Jackson' => JacksonIncome::class,
        'Jasper' => JasperIncome::class,
        'Jay' => JayIncome::class,
        'Jefferson' => JeffersonIncome::class,
        'Jennings' => JenningsIncome::class,
        'Johnson' => JohnsonIncome::class,
        'Knox' => KnoxIncome::class,
        'Kosciusko' => KosciuskoIncome::class,
        'LaGrange' => LaGrangeIncome::class,
        'Lake' => LakeIncome::class,
        'LaPorte' => LaPorteIncome::class,
        'Lawrence' => LawrenceIncome::class,
        'Madison' => MadisonIncome::class,
        'Marion' => MarionIncome::class,
        'Marshall' => MarshallIncome::class,
        'Martin' => MartinIncome::class,
        'Miami' => MiamiIncome::class,
        'Monroe' => MonroeIncome::class,
        'Montgomery' => MontgomeryIncome::class,
        'Morgan' => MorganIncome::class,
        'Newton' => NewtonIncome::class,
        'Noble' => NobleIncome::class,
        'Ohio' => OhioIncome::class,
        'Orange' => OrangeIncome::class,
        'Owen' => OwenIncome::class,
        'Parke' => ParkeIncome::class,
        'Perry' => PerryIncome::class,
        'Pike' => PikeIncome::class,
        'Porter' => PorterIncome::class,
        'Posey' => PoseyIncome::class,
        'Pulaski' => PulaskiIncome::class,
        'Putnam' => PutnamIncome::class,
        'Randolph' => RandolphIncome::class,
        'Ripley' => RipleyIncome::class,
        'Rush' => RushIncome::class,
        'Scott' => ScottIncome::class,
        'Shelby' => ShelbyIncome::class,
        'Spencer' => SpencerIncome::class,
        'St. Joseph' => StJosephIncome::class,
        'Starke' => StarkeIncome::class,
        'Steuben' => SteubenIncome::class,
        'Sullivan' => SullivanIncome::class,
        'Switzerland' => SwitzerlandIncome::class,
        'Tippecanoe' => TippecanoeIncome::class,
        'Tipton' => TiptonIncome::class,
        'Union' => UnionIncome::class,
        'Vanderburgh' => VanderburghIncome::class,
        'Vermillion' => VermillionIncome::class,
        'Vigo' => VigoIncome::class,
        'Wabash' => WabashIncome::class,
        'Warren' => WarrenIncome::class,
        'Warrick' => WarrickIncome::class,
        'Washington' => WashingtonIncome::class,
        'Wayne' => WayneIncome::class,
        'Wells' => WellsIncome::class,
        'White' => WhiteIncome::class,
        'Whitley' => WhitleyIncome::class,
    ];

    public function up(): void
    {
        foreach (parse_ini_file(self::STATE_FILE) as $county_name => $county_geo) {
            if (!array_key_exists($county_name, self::CLASSES)) {
                throw new Exception('Could not find class for '.$county_name);
            }

            $area_id = DB::table('governmental_unit_areas')->insertGetId([
                'name' => $county_name.', IN',
                'area' => $county_geo
            ]);

            $tax_id = DB::table('taxes')->insertGetId([
                'name' => $county_name.' Indiana Tax',
                'class' => self::CLASSES[$county_name],
            ]);

            DB::table('tax_areas')->insert([[
                'tax_id' => $tax_id,
                'home_governmental_unit_area_id' => $area_id,
                'based' => TaxArea::BASED_ON_HOME_LOCATION,
            ]]);
        }
    }

    public function down(): void
    {
        foreach (parse_ini_file(self::STATE_FILE) as $county_name => $county_geo) {
            if (!array_key_exists($county_name, self::CLASSES)) {
                throw new Exception('Could not find class for '.$county_name);
            }

            $area_id = DB::table('governmental_unit_areas')
                ->where('name', '=', $county_name.', IN')->first()->id;

            $tax_id = DB::table('taxes')
                ->where('name', '=', $county_name.' Indiana Tax')->first()->id;

            DB::table('tax_areas')
                ->where('tax_id', '=', $tax_id)
                ->where('home_governmental_unit_area_id', '=', $area_id)
                ->delete();

            DB::table('taxes')->where('id', $tax_id)->delete();
            DB::table('governmental_unit_areas')->where('id', $area_id)->delete();
        }
    }
}
